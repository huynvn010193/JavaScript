<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Title of the document</title>
  </head>
  <script>
    iqTest = (accumalator, currentValue) => {
      console.log(
        `accumalator: ${accumalator} - currentValue: ${currentValue}`
      );
      return accumalator + currentValue;
    };

    function runABC() {
      console.log(
        "===========================Tương tác vs arr=============================="
      );
      // Tương tác vs arr

      const numberArr = [1, 22, 9, 4];
      const a = numberArr.reduce(iqTest, 0);
      console.log(a);

      console.log(
        "===========================Ứng dụng tìm FindMax============================"
      );
      // const findMax = numberArr.reduce((acc,val) => {
      // 	if(val > acc) {
      // 		acc = val
      // 	}
      // 	return acc;
      // });

      let findMax = numberArr.reduce((a, b) => (a > b ? a : b));

      console.log(findMax);

      // Tương tác vs arrObject
      console.log(
        "===========================Tương tác vs arrObject: từ mảng Obj thành 1 Obj=============================="
      );

      // Cho mảng arrObject => tạo thành 1 Object {name: "ABC", job: "CEO", age: 30}
      const arrObject = [
        {
          name: "ABC",
        },
        {
          job: "CEO",
        },
        {
          age: 30,
        },
      ];

      console.log("Trước khi dùng Reduce", arrObject);

      const newObj = arrObject.reduce((accumalator, currentValue) => {
        console.log("accumalator", accumalator);
        console.log("currentValue", currentValue);
        return {
          ...accumalator,
          ...currentValue,
        };
      }, []);

      console.log("Tương tác vs arrObject", newObj);

      // Tương tác Object thường
      console.log(
        "===========================Tương tác Object thường: Nối các value của Object thành chuỗi=============================="
      );
      const obj = {
        name: "ABC",
        job: "CEO",
        age: 30,
      };

      console.log("Object trước khi dùng reducer", obj);

      //console.log( Object.keys(obj));

      const result = Object.keys(obj).reduce((accumalator, key) => {
        console.log("accumalator: ", accumalator);
        console.log("key: ", key);
        return (accumalator += obj[key]);
      }, "");
      console.log("Chuỗi sau khi dùng reducer:", result);

      console.log(
        "=========================== Trải phẳng 1 mảng chứa nhiều mảng con:=============================="
      );
      console.log(
        "=========================== Gôm các phần tử trong mảng lại thành 1 mảng.:=============================="
      );
      const flattened = [
        [0, 1],
        [2, 3],
        [6, 9],
      ];
      console.log("Mảng ban đầu: ", flattened);
      const result2 = flattened.reduce((acc, val) => acc.concat(val), []);
      console.log(result2);

      console.log(
        "=========================== Đếm số lần xuất hiện của phần tử trong mảng =============================="
      );
      const names = ["Alice", "Bob", "Tiff", "Bruce", "Alice"];
      console.log("Cho mảng như sau", names);
      const countedName = names.reduce((allNames, name) => {
        if (name in allNames) allNames[name]++;
        else allNames[name] = 1;
        return allNames;
      }, {});
      console.log("Kết quả", countedName);

      console.log(
        "=========================== Ứng dụng reduce chuyển mảng 2 chiều thành mảng 1 chiều =============================="
      );
      const topics = [
        {
          topic: "ReactJS",
          posts: [
            { postID: "id1", title: "title1" },
            { postID: "id2", title: "title2" },
          ],
        },
        {
          topic: "Vue.js",
          posts: [
            { postID: "id3", title: "title3" },
            { postID: "id4", title: "title4" },
          ],
        },
      ];
      console.log("Cho mảng như sau", topics);

      const arrConvert = topics.reduce((acc, val) => {
        return [...acc, ...val.posts];
      }, []);

      console.log("Kết quả", arrConvert);

      console.log(
        "==== Ứng dụng: Chuyển array thành object theo giá trị của một thuộc tính ====="
      );
      const posts = [
        { postID: "id1", title: "title1" },
        { postID: "id2", title: "title2" },
        { postID: "id3", title: "title3" },
        { postID: "id4", title: "title4" },
      ];
    }
  </script>

  <body onload="runABC()">
    Map-reduce-filter
  </body>
</html>
